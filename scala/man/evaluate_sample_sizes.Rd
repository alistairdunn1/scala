% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/evaulate_sample_sizes.r
\name{evaluate_sample_sizes}
\alias{evaluate_sample_sizes}
\title{Evaluate Sample Sizes for Bootstrap Analysis}
\usage{
evaluate_sample_sizes(
  fish_data,
  min_fish_per_sample = 15,
  min_samples_per_stratum = 8,
  min_sample_proportion = 0.2
)
}
\arguments{
\item{fish_data}{A data frame containing fisheries sampling data with columns:
\describe{
  \item{sample_id}{Unique identifier for each sample}
  \item{stratum}{Stratum identifier (e.g., area, season, gear type)}
  \item{total}{Number of fish in each length/sex/age bin}
  \item{sample_weight_kg}{(Optional) Weight of fish sampled (kg)}
  \item{total_catch_weight_kg}{(Optional) Total catch weight for sample_id (kg)}
}}

\item{min_fish_per_sample}{Minimum number of fish required per sample for
reliable bootstrap resampling (default: 15). Samples with fewer fish may
produce unreliable uncertainty estimates unless they represent a high
proportion of the total catch.}

\item{min_samples_per_stratum}{Minimum number of samples required per stratum
for reliable bootstrap resampling (default: 8). Strata with fewer samples
may produce unreliable uncertainty estimates.}

\item{min_sample_proportion}{Minimum proportion of total catch that a small
sample should represent to be considered adequately representative
(default: 0.2 or 20%). Small samples with high representativeness may be
retained despite low fish counts.}
}
\value{
A list containing:
  \describe{
    \item{sample_sizes}{Data frame with sample sizes for each sample_id and stratum}
    \item{all_small_samples}{Data frame of samples with fewer than minimum fish}
    \item{representative_small_samples}{Data frame of small samples that are highly representative}
    \item{non_representative_small_samples}{Data frame of small samples with poor representativeness}
    \item{small_strata}{Data frame of strata with fewer than minimum samples}
    \item{exclusion_summary}{Data frame summarizing the impact of excluding small samples}
    \item{recommendations}{Character vector with specific recommendations for handling small samples}
  }
}
\description{
Evaluates whether the sample sizes in fisheries data are adequate for reliable
bootstrap uncertainty estimation. This function checks both the number of fish
per sample and the number of samples per stratum against recommended minimum
thresholds for hierarchical bootstrap resampling.
}
\details{
Hierarchical bootstrap resampling requires adequate sample sizes at both levels:
\itemize{
  \item \strong{Sample level}: Each sample should contain at least 15 fish to ensure
    stable resampling of individual fish within samples
  \item \strong{Stratum level}: Each stratum should contain at least 8 samples to ensure
    stable resampling of samples within strata
}

Insufficient sample sizes can lead to:
\itemize{
  \item Unreliable confidence intervals
  \item Unstable bootstrap distributions
  \item Poor uncertainty estimation
  \item Biased variance estimates
}

The function provides recommendations for handling small samples:
\itemize{
  \item \strong{Retain}: When small samples provide important coverage, represent small fraction of data, or are highly representative of their total catch
  \item \strong{Combine strata}: When multiple strata have few samples each
  \item \strong{Consider exclusion}: When samples are extremely small (< 5 fish, regardless of user threshold) and have poor representativeness
  \item \strong{Sensitivity analysis}: Always compare results with and without questionable samples
}

\strong{Representativeness Assessment}: When sample weight and total catch weight
information is available, the function evaluates whether small samples represent
a significant proportion of the total catch. Small samples that represent >= 20%
of the total catch are considered adequately representative despite low fish counts.
}
\examples{
\dontrun{
# Generate test data
test_data <- generate_test_data()

# Evaluate sample sizes with default thresholds
evaluation <- evaluate_sample_sizes(test_data$fish_data)

# Check for any problematic samples or strata
if (nrow(evaluation$small_samples) > 0) {
  print("Samples with insufficient fish:")
  print(evaluation$small_samples)
}

# Review recommendations for handling small samples
cat("Recommendations:\n")
for (rec in evaluation$recommendations) {
  cat("-", rec, "\n")
}

# Check impact of excluding small samples
print(evaluation$exclusion_summary)

# Review representative vs problematic small samples
if (nrow(evaluation$representative_small_samples) > 0) {
  cat("\nHighly representative small samples (retain):\n")
  print(evaluation$representative_small_samples[c("sample_id", "total", "sample_proportion")])
}

if (nrow(evaluation$non_representative_small_samples) > 0) {
  cat("\nProblematic small samples (consider exclusion):\n")
  print(evaluation$non_representative_small_samples[c("sample_id", "total", "sample_proportion")])
}

# Use custom thresholds
strict_evaluation <- evaluate_sample_sizes(
  test_data$fish_data,
  min_fish_per_sample = 20,
  min_samples_per_stratum = 10,
  min_sample_proportion = 0.3 # Require 30\% representativeness
)
}
}
\seealso{
\code{\link{calculate_length_compositions}} for the main bootstrap analysis function
}
